
all: src/version.cpp configgen doxywizard
	cd src ; $(MAKE)

clean: FORCE
	cd examples ; $(MAKE) clean
	cd doc ; $(MAKE) clean
	cd src ; $(MAKE) clean
	cd addon/configgen ; $(MAKE) clean
	cd addon/doxywizard ; $(MAKE) clean
	cd addon/xmlread ; $(MAKE) clean
	-rm -f bin/doxy*
	-rm -f objects/*.o

distclean: clean
	cd examples ; $(MAKE) clean
	cd doc ; $(MAKE) clean
	cd src ; $(MAKE) distclean
	cd addon/configgen ; $(MAKE) distclean
	cd addon/doxywizard ; $(MAKE) distclean
	-rm -f bin/doxy*
	-rm -f html
	-rm -f objects/*.o
	-rm -f src/Makefile.doxygen src/Makefile.doxytag src/Makefile.doxysearch
	-rm -f Makefile src/Makefile examples/Makefile doc/Makefile 
	-rm -f .makeconfig .tmakeconfig
	-rm -f src/doxygen.pro src/doxytag.pro src/doxysearch.pro
	-rm -f src/version.cpp
	-rm -r addon/configgen/Makefile addon/doxywizard/Makefile
	-rm -f addon/configgen/Makefile.configgen 
	-rm -f addon/doxywizard/Makefile.doxywizard
	-rm -f addon/configgen/configgen.pro addon/doxywizard/doxywizard.pro
	-rm -f addon/configgen/obj/*.o
	-rm -f addon/doxywizard/obj/*.o
	-rm -f addon/doxywizard/moc/moc_*
	-rm -f addon/xmlread/xmlread.pro 
	-rm -f addon/xmlread/Makefile addon/xmlread/Makefile.xmlread
	-rm -f addon/xmlread/*.o

install: doxywizard_install
	$(INSTTOOL) -d $(INSTALL)/bin
	$(INSTTOOL) -d $(INSTALL)/doc/doxygen
	$(INSTTOOL) -m 755 bin/doxygen    $(INSTALL)/bin
	$(INSTTOOL) -m 755 bin/doxytag    $(INSTALL)/bin
	$(INSTTOOL) -m 755 bin/doxysearch $(INSTALL)/bin
	cp -r doc $(INSTALL)/doc/doxygen
	cp -r examples $(INSTALL)/doc/doxygen
	echo "DOXYGEN  = $(INSTALL)" > $(INSTALL)/doc/doxygen/doc/Makefile
	echo "DOXYDOCS = .." >> $(INSTALL)/doc/doxygen/doc/Makefile
	echo "VERSION  = $(VERSION)" >> $(INSTALL)/doc/doxygen/doc/Makefile
	cat doc/Makefile.in >> $(INSTALL)/doc/doxygen/doc/Makefile
	cd $(INSTALL)/doc/doxygen/examples ; $(MAKE)
	cd $(INSTALL)/doc/doxygen/doc ; $(MAKE)
	rm -rf $(INSTALL)/doc/doxygen/doc
	cd $(INSTALL)/doc/doxygen/latex ; $(MAKE)
	cp $(INSTALL)/doc/doxygen/latex/doxygen_manual.pdf $(INSTALL)/doc/doxygen
	cp $(INSTALL)/doc/doxygen/latex/doxygen_manual.ps $(INSTALL)/doc/doxygen
	rm -rf $(INSTALL)/doc/doxygen/latex

docs: FORCE
	cd examples ; $(MAKE)
	cd doc ; $(MAKE)

ps: docs
	cd latex ; $(MAKE)

pdf: docs
	cd latex ; $(MAKE)

archive: clean
	tar zcvf dx`date +%y%m%d`.tgz addon tmake doc wintools examples bin objects \
	       src configure configure.bin Makefile.in Makefile.win.in INSTALL \
	       make.bat LANGUAGE.HOWTO LICENSE PLATFORMS VERSION packages

src/version.cpp: Makefile
	echo "char versionString[]=\"$(VERSION)\";" > src/version.cpp

FORCE:

